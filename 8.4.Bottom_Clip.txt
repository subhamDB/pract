#include<iostream>
#include<GL/glut.h>
#include<stdlib.h>
#include<math.h>
using namespace std;

int v, wxmin, wxmax, wymin, wymax, a[10][2];

void init(void) {
    glClearColor(0.0, 0.0, 0.0, 0.0);
    gluOrtho2D(-600.0, 600.0, -600.0, 600.0);
}

int accept_poly(int a[10][2]) {
    int i, n;
    cout << "\nEnter the number of vertices: ";
    cin >> n;
    for(i = 0; i < n; i++) {
        cout << "Enter the coordinates of vertex " << i + 1 << " : ";
        cin >> a[i][0] >> a[i][1];
    }
    return n;
}

int bottomclip(int a[10][2], int v, int wymin) {
    int i, t[10][2];
    int k = 0;
    int x1, y1, x2, y2;
    for(i = 0; i < v; i++) {
        // If the vertex is above the clipping window, keep it
        if(a[i][1] >= wymin) {
            t[k][0] = a[i][0];
            t[k][1] = a[i][1];
            k++;
        }

        // If the edge crosses the bottom boundary, calculate the intersection
        if((a[i][1] > wymin && a[(i + 1) % v][1] < wymin) || (a[i][1] < wymin && a[(i + 1) % v][1] > wymin)) {
            x1 = a[i][0];
            y1 = a[i][1];
            x2 = a[(i + 1) % v][0];
            y2 = a[(i + 1) % v][1];
            // Calculate the intersection point
            t[k][0] = x1 + (wymin - y1) * ((float)(x2 - x1) / (y2 - y1));
            t[k][1] = wymin;
            k++;
        }
    }

    // Copy the clipped points back to the original array
    for(i = 0; i < k; i++) {
        a[i][0] = t[i][0];
        a[i][1] = t[i][1];
    }
    return k;
}

void draw_poly(int a[10][2], int v) {
    int i;
    glBegin(GL_LINES);
    glVertex2i(wxmin, wymin);
    glVertex2i(wxmin, wymax);
    glVertex2i(wxmin, wymax);
    glVertex2i(wxmax, wymax);
    glVertex2i(wxmax, wymax);
    glVertex2i(wxmax, wymin);
    glVertex2i(wxmax, wymin);
    glVertex2i(wxmin, wymin);
    glEnd();
    glFlush();

    // Draw the clipped polygon
    for(i = 0; i < v; i++) {
        glColor3f(1.0, 1.0, 1.0);
        glBegin(GL_LINES);
        glVertex2i(a[i][0], a[i][1]);
        glVertex2i(a[(i + 1) % v][0], a[(i + 1) % v][1]);
        glEnd();
        glFlush();
    }
}

int main(int argc, char** argv) {
    int cl;

    cout << "\nEnter the co-ordinates of the window";
    cout << "\n(Wxmin, Wymin) : ";
    cin >> wxmin >> wymin;
    cout << "\n(Wxmax, Wymax) : ";
    cin >> wxmax >> wymax;

    v = accept_poly(a);

    glutInit(&argc, argv);
    glutInitDisplayMode(GLUT_SINGLE | GLUT_RGB);
    glutInitWindowSize(800, 800);
    glutInitWindowPosition(100, 100);
    glutCreateWindow("Bottom Clipping");

    init();
    glClear(GL_COLOR_BUFFER_BIT);
    draw_poly(a, v);
    glFlush();

    // Perform the bottom clipping operation
    glClear(GL_COLOR_BUFFER_BIT);
    v = bottomclip(a, v, wymin);
    glClear(GL_COLOR_BUFFER_BIT);
    draw_poly(a, v);

    glFlush();
    glutMainLoop();

    return 0;
}
